{% extends 'base.html' %}
{% block title %}{{ event.title }}{% endblock %}
{% block content %}
<div class="max-w-3xl mx-auto bg-white p-6 rounded shadow">
  <!-- Event Image -->
  <img src="{{ event.image.url }}" alt="{{ event.title }}" class="w-full h-64 object-cover rounded mb-4">

  <h1 class="text-3xl font-bold">{{ event.title }}</h1>
  <p class="text-sm text-gray-600">
    By {{ event.organizer.username }} • {{ event.start_time|date:"M d, Y H:i" }}
  </p>
  <p class="mt-4 text-gray-800">{{ event.description }}</p>
  <p class="mt-2"><strong>Location:</strong> {{ event.location }}</p>

  <!-- Actions -->
  <div class="mt-6 flex space-x-3">
    <a href="{% url 'events:list' %}" class="px-4 py-2 bg-gray-200 rounded">Back</a>

    {% if user.is_authenticated %}
      <form method="post" action="{% url 'events:rsvp' event.pk %}">
        {% csrf_token %}
        <input type="hidden" name="status" value="attending">
        <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded">RSVP as Attending</button>
      </form>
    {% else %}
      <a href="{% url 'accounts:login' %}?next={% url 'events:detail' event.pk %}"
         class="px-4 py-2 bg-indigo-600 text-white rounded">Login to RSVP</a>
    {% endif %}

    {% if user == event.organizer or user.is_superuser %}
      <a href="{% url 'events:edit' event.pk %}" 
         class="px-4 py-2 bg-yellow-500 text-white rounded">Edit</a>

      <form method="post" action="{% url 'events:delete' event.pk %}" onsubmit="return confirm('Delete this event?');">
        {% csrf_token %}
        <button type="submit" class="px-4 py-2 bg-red-600 text-white rounded">Delete</button>
      </form>
    {% endif %}
  </div>

  <hr class="my-6">

  <!-- Attendees -->
  <h3 class="text-lg font-semibold mb-2">Attendees</h3>
  <ul class="list-disc pl-5">
    {% for r in event.rsvp_set.all %}
      <li>{{ r.user.username }} — {{ r.status }}</li>
    {% empty %}
      <li>No RSVPs yet.</li>
    {% endfor %}
  </ul>
</div>
{% endblock %}
